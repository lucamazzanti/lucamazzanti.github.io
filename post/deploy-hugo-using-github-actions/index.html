<!doctype html><html xmlns=http://www.w3.org/1999/xhtml xml:lang=en lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.76.5"><title>Set up a static website with Hugo, Forestry and GitHub Pages &#183; maz.io</title><meta name=description content><meta itemprop=name content="Set up a static website with Hugo, Forestry and GitHub Pages"><meta itemprop=description content="I&rsquo;m moving a private knowledge base powered by WordPress to a public blog so seized the opportunity to study a static site generator like Jekyll."><meta itemprop=datePublished content="2020-10-24T14:00:00+00:00"><meta itemprop=dateModified content="2020-10-24T14:00:00+00:00"><meta itemprop=wordCount content="430"><meta itemprop=image content="https://lucamazzanti.github.io/images/netcore.svg"><meta itemprop=keywords content="hugo,github-actions,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://lucamazzanti.github.io/images/netcore.svg"><meta name=twitter:title content="Set up a static website with Hugo, Forestry and GitHub Pages"><meta name=twitter:description content="I&rsquo;m moving a private knowledge base powered by WordPress to a public blog so seized the opportunity to study a static site generator like Jekyll."><meta property="og:title" content="Set up a static website with Hugo, Forestry and GitHub Pages"><meta property="og:description" content="I&rsquo;m moving a private knowledge base powered by WordPress to a public blog so seized the opportunity to study a static site generator like Jekyll."><meta property="og:type" content="article"><meta property="og:url" content="https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/"><meta property="og:image" content="https://lucamazzanti.github.io/images/netcore.svg"><meta property="article:published_time" content="2020-10-24T14:00:00+00:00"><meta property="article:modified_time" content="2020-10-24T14:00:00+00:00"><meta property="og:site_name" content="maz.io"><script type=application/ld+json>{"@context":"https://schema.org","@graph":[{"@type":"Person","@id":"https://lucamazzanti.github.io#author","name":null,"image":{"@type":"ImageObject","url":"https://lucamazzanti.github.io/images/netcore.svg"},"description":"Full-stack .NET Developer"},{"@type":"WebSite","@id":"https://lucamazzanti.github.io#website","url":"https://lucamazzanti.github.io","name":"maz.io","description":"Full-stack .NET Developer","publisher":{"@id":"https://lucamazzanti.github.io#author"},"inLanguage":"en"},{"@type":"ImageObject","url":"https://lucamazzanti.github.io/images/netcore.svg","caption":"maz.io"},{"@type":"WebPage","@id":"https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/#webpage","url":"https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/","name":"Set up a static website with Hugo, Forestry and GitHub Pages","isPartOf":{"@id":"https://lucamazzanti.github.io#website"},"about":{"@id":"https://lucamazzanti.github.io#author"},"datePublished":"2020-10-24T14:00:00+00:00","dateModified":"2020-10-24T14:00:00+00:00","description":"I\u0026rsquo;m moving a private knowledge base powered by WordPress to a public blog so seized the opportunity to study a static site generator like Jekyll.","inLanguage":"en","potentialAction":[{"@type":"ReadAction","target":["https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/"]}]},{"@type":"Article","isPartOf":{"@id":"https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/#webpage"},"mainEntityOfPage":{"@id":"https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/#webpage"},"headline":"Set up a static website with Hugo, Forestry and GitHub Pages","datePublished":"2020-10-24T14:00:00+00:00","dateModified":"2020-10-24T14:00:00+00:00","publisher":{"@id":"https://lucamazzanti.github.io#author"},"keywords":["hugo","github-actions"],"articleSection":[],"inLanguage":"en","author":{"@type":"Person","name":null},"potentialAction":[{"@type":"CommentAction","name":"Comment","target":["https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/#comments"]}]}]}</script><link type=text/css rel=stylesheet href=/css/print.css media=print><link type=text/css rel=stylesheet href=/css/poole.css><link type=text/css rel=stylesheet href=/css/hyde.css><style type=text/css>.sidebar{background-color:#5c2d91}.read-more-link a{border-color:#5c2d91}.pagination li a{color:#5c2d91;border:1px solid #5c2d91}.pagination li.active a{background-color:#5c2d91}.pagination li a:hover{background-color:#5c2d91;opacity:.75}footer a,.content a,.related-posts li a:hover{color:#5c2d91}</style><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700&display=swap"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin=anonymous><link rel=apple-touch-icon-precomposed sizes=144x144 href=/apple-touch-icon-144-precomposed.png><link rel="shortcut icon" href=/favicon.png></head><body><aside class=sidebar><div class=container><div class=sidebar-about><div class=author-image><img src=/images/netcore.svg class="img-circle img-headshot center" alt="Profile Picture"></div><h1>maz.io</h1><p class=lead>Full-stack .NET Developer</p></div><nav><ul class=sidebar-nav><li><a href=https://lucamazzanti.github.io>Home</a></li><li><a href=/about/>About</a></li><li><a href=/contact/>Contact</a></li><li><a href=/posts/>Posts</a></li><li><a href=/categories/>Categories</a></li><li><a href=/tags/>Tags</a></li></ul></nav><section class=social-icons><a href=https://www.linkedin.com/in/lucamazzanti/ rel=me title=Linkedin target=_blank><i class="fab fa-linkedin" aria-hidden=true></i></a><a href=https://github.com/lucamazzanti rel=me title=GitHub target=_blank><i class="fab fa-github" aria-hidden=true></i></a></section></div></aside><main class="content container"><div class=post><h1 class=title>Set up a static website with Hugo, Forestry and GitHub Pages</h1><div class=post-date><time datetime=2020-10-24T14:00:00Z>Oct 24, 2020</time> &#183; 3 min read</div><div><p>I&rsquo;m moving a private knowledge base powered by WordPress to a public blog so seized the opportunity to study a static site generator like <a href=https://jekyllrb.com>Jekyll</a>.</p><p>I chose <a href=https://gohugo.io/>Hugo</a> and a theme named <a href=https://github.com/alexandrevicenzi/soho>Soho</a>.</p><p><img src=/uploads/screenshot-soho_hu184257ff17e4a0e38cca784bc2936c0c_113451_750x500_fill_catmullrom_top_2.png alt title="Soho theme"></p><p>To keep the theme updated I&rsquo;m going to use a submodule.</p><pre><code>git submodule add https://github.com/alexandrevicenzi/soho.git themes/soho
</code></pre><p>I use <a href=https://forestry.io>Forestry.io</a> to manage contents like a CMS and keep sinchronized data with a private repository where I put a Hugo installation. During the setup Forestry put a Deploy Key on that repo to have write permissions.</p><p><img src=/uploads/3b31b28e29bc969283474fa432d038516e1e137f.jpg alt title="Forestry editor"></p><p><a href=https://pages.github.com>GitHub Pages</a> offers a static site hosting service available at <em>https://.github.io</em> where is content is read from the master root folder of a public repository of the same name.</p><p>I&rsquo;m going to use two different repositories:</p><ul><li>one private for Hugo where I manage my contents and build the web site</li><li>one public hosting the web site</li></ul><p>Every time I make a change on the private repository, I must commit on it, build the web site and then publish all the content to the public repository. This can be done in two ways: using <em>git submodules</em> to manage two repos in one or using <em>GitHub Actions</em> to automate the deploy. I tried both but the first is more difficult because it asks some manually operations, so I&rsquo;m going to use the GitHub CI/CD pipeline.</p><p>I&rsquo;m using the <a href=https://github.com/marketplace/actions/hugo-setup>most starred action</a> to build and deploy with Hugo:</p><pre><code>name: publish
# on every commit in the master branch
on:  
  push:
    branches: [ master ]
jobs:
  # it starts a job named build
  build:
    runs-on: ubuntu-latest
    steps:
      # it checkout the master branch and init/update the submodules (the themes)
      - uses: actions/checkout@v2
        with:
          submodules: true
          fetch-depth: 0
      # it prepares the hugo command line on ubuntu
      - name: Setup Hugo
        uses: peaceiris/actions-hugo@v2
        with:
          hugo-version: '0.76.5'
      # it builds the contents
      - name: Build
        run: hugo --minify
      # it deploys the build on another repository
      - name: Deploy
        uses: peaceiris/actions-gh-pages@v3
        #docs: https://github.com/peaceiris/actions-gh-pages
        with:
          personal_token: ${{ secrets.PERSONAL_TOKEN }}
          publish_dir: ./public
          external_repository: &lt;username&gt;/&lt;username&gt;.github.io
          user_name: &lt;username&gt;
          publish_branch: master
</code></pre><p>Having these two repositories under the same user I can use a GitHub personal token to share permissions across them, you must generate it and put the hash in the private repository secrets so it can use it during the build. In more complex scenario you can use a deploy key on the destination and a secret on the source.</p><p>Now the workflow is complete:</p><ol><li>when I edit a page on forestry it commits on my first repository</li><li>on commit it starts this action that will publish the content to che second one</li></ol></div><div><ul class=tags><li><a href=https://lucamazzanti.github.io/tags/hugo/ class=tag-link>hugo</a></li><li><a href=https://lucamazzanti.github.io/tags/github-actions/ class=tag-link>github-actions</a></li></ul></div><div class=share-buttons><a class=twitter-share-button href=# title="Share on Twitter" data-url=https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/ data-text="Set up a static website with Hugo, Forestry and GitHub Pages"><i class="fab fa-twitter"></i></a><a class=linkedin-share-button href=# title="Share on LinkedIn" data-url=https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/ data-text="Set up a static website with Hugo, Forestry and GitHub Pages"><i class="fab fa-linkedin-in"></i></a><a class=facebook-share-button href=# title="Share on Facebook" data-url=https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/ data-text="Set up a static website with Hugo, Forestry and GitHub Pages"><i class="fab fa-facebook"></i></a><a class=telegram-share-button href=# title="Share on Telegram" data-url=https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/ data-text="Set up a static website with Hugo, Forestry and GitHub Pages"><i class="fab fa-telegram"></i></a><a class=pinterest-share-button href=# title="Share on Pinterest" data-url=https://lucamazzanti.github.io/post/deploy-hugo-using-github-actions/ data-text="Set up a static website with Hugo, Forestry and GitHub Pages"><i class="fab fa-pinterest"></i></a></div></div><h2>Comments</h2><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"https-lucamazzanti-github-io"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></main><footer><div><p>&copy; Luca Mazzanti 2020
&#183; <a href=https://creativecommons.org/licenses/by-sa/4.0 target=_blank>CC BY-SA 4.0</a>
&#183; Build with <a href=https://gohugo.io/ target=_blank>Hugo</a> & <a href=https://themes.gohugo.io/soho/ target=_blank>Soho</a> theme</p></div></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/js/all.min.js integrity="sha256-MAgcygDRahs+F/Nk5Vz387whB4kSK9NXlDN3w58LLq0=" crossorigin=anonymous></script><script src=/js/jquery.min.js></script><script src=/js/soho.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-181063409-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>